(()=>{"use strict";class e{constructor(e,t,n="div",s=""){this.node=document.createElement(n),this.node.className=t,this.node.innerText=s,this.parent=e}renderNode(){this.parent.append(this.node)}}class t extends e{constructor(e,t,n="key",s=t){super(e,n,"button",t),this.node.dataset.key=s}}class n{static changeCaps(e){const t=document.querySelectorAll(".key");e?t.forEach((e=>{e.innerText=e.innerText.toUpperCase(),e.dataset.key=e.dataset.key.toUpperCase()})):t.forEach((e=>{e.innerText=e.innerText.toLowerCase(),e.dataset.key=e.dataset.key.toLowerCase()}))}static focus(){const e=document.querySelector("textarea");return e.focus(),e}static pressKey(e){const t=n.focus(),s=t.selectionStart;t.value=t.value.slice(0,s)+e+t.value.slice(s),t.selectionStart=t.selectionEnd=s+1}static pressBackspace(){const e=n.focus(),t=e.selectionStart;e.value=e.value.slice(0,t-1)+e.value.slice(t),e.selectionStart=e.selectionEnd=t-1}static pressTab(){const e=n.focus(),t=e.selectionStart;e.value=`${e.value.slice(0,t)}\t${e.value.slice(t)}`,e.selectionStart=e.selectionEnd=t+1}static pressEnter(){const e=n.focus(),t=e.selectionStart;e.value=`${e.value.slice(0,t)}\n${e.value.slice(t)}`,e.selectionStart=e.selectionEnd=t+1}static pressDel(){const e=n.focus(),t=e.selectionStart;e.value=e.value.slice(0,t)+e.value.slice(t+1),e.selectionStart=e.selectionEnd=t}static pressArrow(e){const t=n.focus(),s=t.selectionStart;t.value=t.value.slice(0,s)+e+t.value.slice(s),t.selectionStart=t.selectionEnd=s+1}static pressSpace(){const e=n.focus(),t=e.selectionStart;e.value=`${e.value.slice(0,t)} ${e.value.slice(t)}`,e.selectionStart=e.selectionEnd=t+1}static pressCaps(){n.focus();const e=document.querySelector(".caps");localStorage.getItem("isCaps")&&localStorage.getItem("isCaps")?(e.classList.remove("active"),n.changeCaps(),localStorage.setItem("isCaps","")):(e.classList.add("active"),n.changeCaps("true"),localStorage.setItem("isCaps","true"))}static changeLanguage(){"RU"==(localStorage.getItem("language")&&"RU"===localStorage.getItem("language")?"RU":"EN")?localStorage.setItem("language","EN"):localStorage.setItem("language","RU")}}const s={lineOne:"`1234567890-=",lineTwo:"qwertyuiop[]\\",lineThree:"asdfghjkl;'",lineFour:"zxcvbnm,./",lineOneShift:"~!@#$%^&*()_+",lineTwoShift:"QWERTYUIOP{}|",lineThreeShift:'ASDFGHJKL:"',lineFourShift:"ZXCVBNM<>?"},r={lineOne:"ё1234567890-=",lineTwo:"йцукенгшщзхъ\\",lineThree:"фывапролджэ",lineFour:"ячсмитьбю.",lineOneShift:'Ё!"№;%:?*()_+',lineTwoShift:"ЙЦУКЕНГШЩЗХЪ/",lineThreeShift:"ФЫВАПРОЛДЖЭ",lineFourShift:"ЯЧСМИТЬБЮ,"};class o{constructor(e){this.parent=e}renderLine(e,s){e.forEach((e=>{const r=new t(s,e);r.renderNode(),r.node.onclick=()=>{n.pressKey(r.node.innerHTML)}}))}pressShift(e){e?(o.clearLines(),this.renderKeyboard(e)):(o.clearLines(),this.renderKeyboard())}static clearLines(e=""){document.querySelectorAll(".lineKeys").forEach((e=>{e.remove()}))}renderKeyboard(e=""){const o=localStorage.getItem("language")&&"RU"===localStorage.getItem("language")?r:s,a=!!localStorage.getItem("isCaps")&&!!localStorage.getItem("isCaps"),c=e?"lineOneShift":"lineOne",i=e?"lineTwoShift":"lineTwo",l=e?"lineThreeShift":"lineThree",d=e?"lineFourShift":"lineFour",p=a?o[c].toUpperCase().split(""):o[c].split(""),u=a?o[i].toUpperCase().split(""):o[i].split(""),h=a?o[l].toUpperCase().split(""):o[l].split(""),S=a?o[d].toUpperCase().split(""):o[d].split(""),f=[],w=document.createElement("div"),g=document.createElement("div"),m=document.createElement("div"),y=document.createElement("div"),k=document.createElement("div");f.push(w,g,m,y,k),f.forEach(((e,t)=>{e.className="lineKeys",e.id=t+1}));const v=new t(w,"Backspace","backspace"),L=new t(g,"Tab","tab"),C=new t(g,"DEL","del","Delete"),T=new t(m,"CapsLock","caps");localStorage.getItem("isCaps")&&T.node.classList.add("active");const N=new t(m,"Enter","enter"),E=new t(y,"Shift","shift","ShiftRight"),b=new t(y,"Shift","shift","ShiftLeft"),A=new t(y,"▲","arrows","ArrowUp"),x=new t(k,"◄","arrows","ArrowLeft"),I=new t(k,"►","arrows","ArrowRight"),K=new t(k,"▼","arrows","ArrowDown"),U=new t(k,"Ctrl","ctrl","ControlRight"),R=new t(k,"Ctrl","ctrl","ControlLeft"),D=new t(k,"Win","win","Meta"),q=new t(k,"Alt","alt","AltRight"),F=new t(k,"Alt","alt","AltLeft"),O=new t(k,"","space","Space");this.renderLine(p,w),v.renderNode(),v.node.onclick=n.pressBackspace,L.renderNode(),L.node.onclick=n.pressTab,this.renderLine(u,g),C.renderNode(),C.node.onclick=n.pressDel,T.renderNode(),T.node.onclick=n.pressCaps,this.renderLine(h,m),N.renderNode(),N.node.onclick=n.pressEnter,b.renderNode(),b.node.onmousedown=()=>{this.pressShift("press")},b.node.onmouseup=()=>{this.pressShift(),n.focus()},this.renderLine(S,y),A.renderNode(),A.node.onclick=()=>{n.pressArrow(A.node.innerText)},E.renderNode(),E.node.onmousedown=()=>{this.pressShift("press")},E.node.onmouseup=()=>{this.pressShift(),n.focus()},R.renderNode(),D.renderNode(),F.renderNode(),O.renderNode(),O.node.onclick=n.pressSpace,q.renderNode(),x.renderNode(),x.node.onclick=()=>{n.pressArrow(x.node.innerText)},K.renderNode(),K.node.onclick=()=>{n.pressArrow(K.node.innerText)},I.renderNode(),I.node.onclick=()=>{n.pressArrow(I.node.innerText)},U.renderNode(),this.parent.node.append(w,g,m,y,k)}}const a="RSS Виртуальная клавиатура",c="Клавиатура создана в операционной системе Windows\n  Для переключения языка используется комбинация: левый Alt + Shift",i=new e(document.body,"","h1",a),l=new e(document.body,"","p",c),d=new e(document.body,"app"),p=new e(d.node,"screen","textarea"),u=new e(d.node,"keyboard");i.renderNode(),d.renderNode(),l.renderNode(),p.renderNode(),p.node.focus(),u.renderNode();const h=new o(u);h.renderKeyboard(),document.onkeydown=e=>{p.node.focus(),e.altKey&&e.shiftKey&&(o.clearLines(),n.changeLanguage(),h.renderKeyboard()),"CapsLock"===e.code&&n.pressCaps(),"Alt"===e.key&&e.preventDefault(),"Tab"===e.code&&(e.preventDefault(),n.pressTab()),"Shift"===e.key&&(o.clearLines(),h.renderKeyboard("shift")),document.querySelectorAll(".keyboard button").forEach((t=>{t.dataset.key!==e.key&&t.dataset.key!==e.code||"CapsLock"===t.dataset.key||(t.classList.contains("arrows")&&(e.preventDefault(),n.pressArrow(t.innerText)),t.classList.add("active"))}))},document.onkeyup=e=>{"Shift"===e.key&&(o.clearLines(),h.renderKeyboard()),document.querySelectorAll(".keyboard button").forEach((e=>{"CapsLock"!==e.innerText&&e.classList.remove("active")}))}})();